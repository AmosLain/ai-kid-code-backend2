<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title><h1>üé® AI Art Magic! - Created by Oshri Natan</p></h1>
</title>
  <style>
    body {
      font-family: 'Comic Neue', 'Comic Sans MS', cursive;
      background: linear-gradient(135deg, #fce4ec 0%, #e0f7fa 100%);
      margin: 0;
      padding: 20px;
      text-align: center;
      color: #004d40;
    }
    h1 {
      font-size: 2.5rem;
      color: #00796b;
      text-shadow: 2px 2px 4px rgba(0,121,107,0.3);
      margin-bottom: 1rem;
    }
    .container {
      max-width: 800px;
      margin: 0 auto;
      background: rgba(255, 255, 255, 0.9);
      padding: 2rem;
      border-radius: 20px;
      box-shadow: 0 8px 32px rgba(0,77,64,0.2);
    }
    .input-group {
      margin: 1.5rem 0;
    }
    input[type="text"] {
      padding: 10px;
      font-size: 1.1rem;
      width: 70%;
      max-width: 400px;
      border: 2px solid #00796b;
      border-radius: 10px;
      background: #e0f7fa;
    }
    .options {
      margin: 1rem 0;
    }
    .options label {
      margin: 0 15px;
      font-size: 1.1rem;
    }
    button {
      background: linear-gradient(135deg, #4caf50 0%, #45a049 100%);
      color: white;
      border: none;
      padding: 12px 25px;
      border-radius: 25px;
      cursor: pointer;
      font-size: 1rem;
      box-shadow: 0 4px 15px rgba(76,175,80,0.4);
      transition: all 0.3s ease;
      margin: 0 10px;
    }
    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(76,175,80,0.6);
    }
    #result {
      margin-top: 2rem;
      min-height: 200px;
    }
    #loading {
      font-size: 1.2rem;
      color: #00796b;
    }
    .clear-btn {
      background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%);
    }
    .download-btn {
      background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%);
      margin-top: 1rem;
    }
    @media (max-width: 600px) {
      h1 { font-size: 2rem; }
      input[type="text"] { width: 90%; }
      button { display: block; margin: 10px auto; width: 200px; }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üé® AI Art Magic! - by Oshri Natan</h1>
    <p>Type what you want to see and watch the magic happen! ‚ú®</p>

    <div class="input-group">
      <label for="prompt">What do you want to create?</label><br>
      <input type="text" id="prompt" placeholder="e.g., a happy rainbow dragon">
    </div>

    <div class="options">
      <label>Quick Ideas:</label><br>
      <button onclick="document.getElementById('prompt').value='üåà Rainbow'">üåà Rainbow</button>
      <button onclick="document.getElementById('prompt').value='üê∂ Puppy'">üê∂ Puppy</button>
      <button onclick="document.getElementById('prompt').value='ü¶ã Butterfly'">ü¶ã Butterfly</button>
      <button onclick="document.getElementById('prompt').value='üê≤ Dragon'">üê≤ Dragon</button>
      <button onclick="document.getElementById('prompt').value='ü¶Ñ Unicorn'">ü¶Ñ Unicorn</button>
    </div>

    <div class="input-group">
      <label for="size">Image Size:</label><br>
      <input type="radio" id="small" name="size" value="512x512" checked>
      <label for="small">Small (512x512)</label>
      <input type="radio" id="large" name="size" value="1024x1024">
      <label for="large">Large (1024x1024)</label>
    </div>

    <div>
      <button onclick="generateImage()">‚ú® Create My Art!</button>
      <button class="clear-btn" onclick="clearResult()">üóëÔ∏è Clear</button>
    </div>

    <div id="result">
      <div id="loading" style="display:none;">Creating your magical art... üé®<br>This might take a moment!</div>
      <div id="imageContainer"></div>
    </div>

    <div id="download" style="display:none;">
      <button class="download-btn" onclick="downloadImage()">üíæ Download My Creation</button>
      <p>Right-click and "Save As" to download</p>
    </div>
  </div>

  <script>
    async function generateImage() {
      const prompt = document.getElementById('prompt').value.trim();
      const size = document.querySelector('input[name="size"]:checked').value;
      const lang = 'en'; // Hardcoded for now, can expand later

      if (!prompt) {
        alert('Please enter a prompt!');
        return;
      }

      document.getElementById('loading').style.display = 'block';
      document.getElementById('imageContainer').innerHTML = '';
      document.getElementById('download').style.display = 'none';

      try {
        const response = await fetch('/generate', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ prompt, size, lang })
        });
        const data = await response.json();

        document.getElementById('loading').style.display = 'none';
        document.getElementById('imageContainer').innerHTML = data.code;
        document.getElementById('download').style.display = 'block';

        // Auto-scroll to result
        document.getElementById('result').scrollIntoView({ behavior: 'smooth' });
      } catch (error) {
        document.getElementById('loading').style.display = 'none';
        document.getElementById('imageContainer').innerHTML = '<p>Error loading image. Please try again!</p>';
        console.error('Generate image error:', error);
      }
    }

    function clearResult() {
      document.getElementById('prompt').value = '';
      document.getElementById('imageContainer').innerHTML = '';
      document.getElementById('download').style.display = 'none';
    }

    function downloadImage() {
      const img = document.querySelector('#imageContainer img');
      if (img) {
        const link = document.createElement('a');
        link.href = img.src;
        link.download = `ai_art_${Date.now()}.png`;
        link.click();
      } else {
        alert('No image to download!');
      }
    }
  </script>
</body>
</html>